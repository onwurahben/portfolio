<svg width="1450" height="620" viewBox="0 0 1450 620" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .box {
        fill: #ffffff;
        stroke: #d1d5db;
        stroke-width: 1.2;
        rx: 10;
      }
      .core {
        stroke: #2563eb;
        stroke-width: 1.6;
      }
      .filler {
        fill: #eff6ff;
        stroke: #3b82f6;
        stroke-dasharray: 4;
      }
      .arrow {
        stroke: #9ca3af;
        stroke-width: 1.2;
        fill: none;
        marker-end: url(#arrowhead);
      }
      .label {
        font-family: Inter, system-ui, sans-serif;
        font-size: 13px;
        fill: #111827;
        font-weight: 500;
      }
      .muted {
        font-size: 12px;
        fill: #6b7280;
      }
      .path-label {
        font-family: Inter, system-ui, sans-serif;
        font-size: 11px;
        fill: #4b5563;
        font-weight: 600;
      }
    </style>

    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#9ca3af"/>
    </marker>
  </defs>

  <!-- ENTRY -->
  <rect x="20" y="270" width="140" height="60" class="box"/>
  <text x="90" y="300" text-anchor="middle" class="label">User Message</text>
  <text x="90" y="318" text-anchor="middle" class="muted">Voice / Web Chat</text>

  <!-- HANDSHAKE -->
  <rect x="180" y="270" width="160" height="60" class="box" style="fill: #f9d5a7; stroke: #333;"/>
  <text x="260" y="295" text-anchor="middle" class="label">Early Handshake</text>
  <text x="260" y="315" text-anchor="middle" class="muted">Immediate ACK</text>

  <!-- CLASSIFICATION -->
  <rect x="360" y="270" width="220" height="60" class="box core"/>
  <text x="470" y="295" text-anchor="middle" class="label">Intent Classification</text>
  <text x="470" y="315" text-anchor="middle" class="muted">Groq / Llama 8B</text>

  <!-- ROUTER -->
  <rect x="620" y="270" width="160" height="60" class="box core"/>
  <text x="700" y="300" text-anchor="middle" class="label">Intent Router</text>
  <text x="700" y="318" text-anchor="middle" class="muted">LangGraph DAG</text>

  <!-- BRANCHES (COL 5) -->
  <!-- Greeting -->
  <rect x="880" y="40" width="200" height="60" class="box"/>
  <text x="980" y="75" text-anchor="middle" class="label">Handle Greeting</text>

  <!-- RAG -->
  <rect x="880" y="120" width="200" height="60" class="box"/>
  <text x="980" y="150" text-anchor="middle" class="label">RAG Retrieval</text>
  <text x="980" y="170" text-anchor="middle" class="muted">Pinecone / BGE-Small</text>

  <!-- Cancel -->
  <rect x="880" y="200" width="200" height="60" class="box"/>
  <text x="980" y="235" text-anchor="middle" class="label">Handle Cancellation</text>

  <!-- Capture Details -->
  <rect x="880" y="280" width="200" height="60" class="box"/>
  <text x="980" y="315" text-anchor="middle" class="label">Capture Details</text>

  <!-- Filler Status -->
  <rect x="880" y="360" width="200" height="60" class="box filler"/>
  <text x="980" y="390" text-anchor="middle" class="label">Provide Filler</text>
  <text x="980" y="410" text-anchor="middle" class="muted">Latency Masking</text>

  <!-- Filler Avail -->
  <rect x="880" y="440" width="200" height="60" class="box filler"/>
  <text x="980" y="470" text-anchor="middle" class="label">Provide Filler</text>
  <text x="980" y="490" text-anchor="middle" class="muted">Latency Masking</text>

  <!-- Filler Confirm -->
  <rect x="880" y="520" width="200" height="60" class="box filler"/>
  <text x="980" y="550" text-anchor="middle" class="label">Provide Filler</text>
  <text x="980" y="570" text-anchor="middle" class="muted">Latency Masking</text>


  <!-- COL 6 -->
  <!-- Check Status -->
  <rect x="1160" y="360" width="220" height="60" class="box"/>
  <text x="1270" y="390" text-anchor="middle" class="label">Check Appt Status</text>
  <text x="1270" y="410" text-anchor="middle" class="muted">Google Calendar API</text>

  <!-- Check Avail -->
  <rect x="1160" y="440" width="220" height="60" class="box"/>
  <text x="1270" y="470" text-anchor="middle" class="label">Check Availability</text>
  <text x="1270" y="490" text-anchor="middle" class="muted">Live Conflict Check</text>

  <!-- Final Confirm -->
  <rect x="1160" y="520" width="220" height="60" class="box"/>
  <text x="1270" y="550" text-anchor="middle" class="label">Confirm Appointment</text>
  <text x="1270" y="570" text-anchor="middle" class="muted">Update Google Calendar</text>

  <!-- Missing Info END -->
  <!-- No box needed for simple logical branch, just text or a generic output -->


  <!-- ARROWS -->
  <!-- Main Path -->
  <path d="M160 300 L180 300" class="arrow"/>
  <path d="M340 300 L360 300" class="arrow"/>
  <path d="M580 300 L620 300" class="arrow"/>

  <!-- Router Branches (Single point branching) -->
  <!-- Exit line from Router (No arrowhead) -->
  <path d="M780 300 L820 300" stroke="#9ca3af" stroke-width="1.2" fill="none"/>
  <!-- Vertical Bus -->
  <path d="M820 70 L820 550" stroke="#9ca3af" stroke-width="1.2" fill="none"/>
  
  <!-- Horizontal segments to nodes -->
  <path d="M820 70 L880 70" class="arrow"/>
  <text x="830" y="65" class="path-label">Greeting</text>

  <path d="M820 150 L880 150" class="arrow"/>
  <text x="830" y="145" class="path-label">FAQ</text>

  <path d="M820 230 L880 230" class="arrow"/>
  <text x="830" y="225" class="path-label">Cancel</text>

  <path d="M820 310 L880 310" class="arrow"/>
  <text x="830" y="305" class="path-label">Booking</text>

  <path d="M820 390 L880 390" class="arrow"/>
  <text x="830" y="385" class="path-label">Status</text>

  <path d="M820 470 L880 470" class="arrow"/>
  <text x="830" y="465" class="path-label">Search</text>

  <path d="M820 550 L880 550" class="arrow"/>
  <text x="830" y="545" class="path-label">Confirm</text>

  <!-- Connect Filler to Logic -->
  <path d="M1080 390 L1160 390" class="arrow"/>
  <path d="M1080 470 L1160 470" class="arrow"/>
  <path d="M1080 550 L1160 550" class="arrow"/>

  <!-- Parallel RAG Prefetch -->
  <path d="M470 270 L470 150 L880 150" stroke="#3b82f6" stroke-width="1.2" stroke-dasharray="4" fill="none" marker-end="url(#arrowhead)"/>
  <text x="475" y="145" class="path-label" style="fill: #2563eb;">Parallel Pre-fetch</text>

  <!-- Capture to Avail (Rerouted to avoid overlap) -->
  <path d="M1080 310 L1120 310 L1120 470 L1080 470" class="arrow"/>
  <text x="1125" y="440" class="path-label">Has Info</text>

  <!-- NOTE -->
  <text x="725" y="30" text-anchor="middle" style="font-family: Inter, system-ui, sans-serif; font-size: 16px; fill: #111827; font-weight: 700;">
    LangGraph-Powered Multi-Turn Voice Logic
  </text>
</svg>
